<!DOCTYPE html>
<html>
  <head>
    <title>React + Rails</title>
    <meta charset="utf-8">
    <style>
      @import url(https://fonts.googleapis.com/css?family=Yanne+Kaffeesatz);
      @import url(https://fonts.googleapis.com/css?family=Droid+Serif:400,700,400italic);
      @import url(https://fonts.googleapis.com/css?family=Ubuntu+Mono:400,700,400italic);

      body { font-family: 'Droid Serif'; }
      h1, h2, h3 {
        font-family: 'Yanone Kaffeesatz';
        font-weight: normal;
      }
      .remark-code, .remark-inline-code { font-family: 'Ubuntu Mono'; }
    </style>
  </head>
  <body>
    <textarea id="source">

      class: center, middle

      # React + Rails Intro

      ---

      # Agenda

      1. Why use React?

      2. How do I React in Rails?

      3. React 10,000 ft view

      4. Flux

      5. Follow up

      ---

      # Why use React?

      - Do you want a fast rich client? Or as some might say, ambitious?

      - It's not a framework, use Ember (or your favorite Javascript framework)

      - React is just the view layer, but Rails already gives me a view layer!

      ---

      # I don't have an ambitious app..but I do have

      .center[![image](./jquery-style-vs-react-style.png)]

      ---

      # How do I React in Rails?

      Do it by hand if you're sadistic:
      - Webpack. The goal is to generate a "bundle" that Rail's application.js uses or in your layouts directly

      Basic use cases where you want some JSX components asset compiled and sprinkled in:
      - gem 'react-rails'
      - global name space pollution

      Drink the JavaScript kool-aid that's already pre mixed:
      - gem 'react_on_rails'
      - JavaScript stays a 1st class citizen vs Gemified JS/Removes Globals on window
      - Hot reloading
      - Any other tools in the Node ecosystem

      ---

      .center[![image](./ilovecomponents.jpg)]

      Do you really love components or are you just saying that? Looks like you're mixing HTML with JS, violating Separation of Concerns

      ```js
      export default class Tweet extends React.Component {
        render() {
          return (
            <li className="collection-item avatar">
              <img src={this.props.gravatar} className="circle" />
              <span className="title">{this.props.name}</span>
              <time>{this.props.formattedDate}</time>
              <p>{this.props.body}</p>
            </li>
          )
        }
      }
      ```
      <h5>"UI presentation and UI interaction are closely intertwined. Ever work on a project with index.html and then one big app.js of jQuery select/trigger soup? 
        That's not separation of concerns. That's just indirection." --redditor </h5>

      ---

      # "Mutate" the Immutable State
      - Ok so you just gave me weird JS looking thing with HTML that takes in some data. How do I do something dynamic?

      ```jsx
      class Main extends React.Component {
        constructor(props) {
          super(props);
          this.state = { tweetsList: [] };
        }

        addTweet(tweetToAdd) {
          // grab the current tweet list state
          let newTweetsList = this.state.tweetsList;
          // modify a copy of it
          newTweetsList.unshift({ id: Date.now(), name: 'Guest', body: tweetToAdd });
          //let React merge the new state and cause a re-render
          this.setState({ tweetsList: newTweetsList });
        }

        render() {
          return (
          <div className="container">
            //Note: We're passing an event handler to the TweetBox
            <TweetBox sendTweet={this.addTweet.bind(this)}/>
            <TweetsList tweets={this.state.tweetsList}/>
          </div>
          );
        }
      }
      ```

      ---

      ```js
      class TweetBox extends React.Component {
        handleNewTweet(event) {
          event.preventDefault()
          // Recall that the Main component passed an event handler called sendTweet
          // We call that event handler with the tweet's text value
          // when the form triggers this component's local function
          this.props.sendTweet(this.refs.tweetTextArea.value);
          this.refs.tweetTextArea.value = '';
        }

        render() {
          return (
          <div className="row">
            // Trigger local function that calls the Main component's
            // event handler for adding a tweet
      *     <form onSubmit={this.handleNewTweet.bind(this)}>
              <div className="input-field">
                <label>What's happening?</label>
                <textarea ref="tweetTextArea" className="materialize-textarea" />
                  <button type="submit" className="btn right">Tweet</button>
              </div>
            </form>
          </div>
          );
        }
      }
      ```

      ---

      # <strike>jQuery spaghetti</strike> What now?
      Let's fetch real data from our Rails backend because Rails isn't dead.

      ```js
      class Main extends React.Component {
        // constructor omitted

        addTweet(tweetToAdd) {
          $.post("/tweets", {body: tweetToAdd})
          .success( savedTweet => {
            let newTweetsList = this.state.tweetsList;
            newTweetsList.unshift(savedTweet);
            this.setState({ tweetsList: newTweetsList });
            })
          .error(error => console.log(error));
        }

        componentDidMount() {
          $.ajax("/tweets")
          .success(data => this.setState({ tweetsList: data }))
          .error(error => console.log(error))
        }

        //render omitted
      }
      ```

    </textarea>
    <script src="https://remarkjs.com/downloads/remark-latest.min.js">
    </script>
    <script>
      var slideshow = remark.create();
    </script>
  </body>
</html>

